import{B as f,b as c,c as b}from"./constants.BP25BUWi.js";import"./config.CJuguDtl.js";import{p as g,u as y}from"./url-utils.DnZ9lS3n.js";import"./zh_TW.D-i86LJH.js";const m=!!document.getElementById("banner-wrapper");function u(e,t){document.addEventListener("click",n=>{let o=document.getElementById(e),i=n.target;if(i instanceof Node){for(let s of t){let a=document.getElementById(s);if(a==i||a?.contains(i))return}o.classList.add("float-panel-closed")}})}u("display-setting",["display-setting","display-settings-switch"]);u("nav-menu-panel",["nav-menu-panel","nav-menu-switch"]);u("search-panel",["search-panel","search-bar","search-switch"]);function E(){document.querySelectorAll(".katex-display:not([data-scrollbar-initialized])").forEach(t=>{if(!t.parentNode)return;const n=document.createElement("div");n.className="katex-display-container",t.parentNode.insertBefore(n,t),n.appendChild(t),n.style.cssText=`
			overflow-x: auto;
			scrollbar-width: thin;
			scrollbar-color: rgba(0,0,0,0.3) transparent;
		`;const o=document.createElement("style");o.textContent=`
			.katex-display-container::-webkit-scrollbar {
				height: 6px;
			}
			.katex-display-container::-webkit-scrollbar-track {
				background: transparent;
			}
			.katex-display-container::-webkit-scrollbar-thumb {
				background: rgba(0,0,0,0.3);
				border-radius: 3px;
			}
			.katex-display-container::-webkit-scrollbar-thumb:hover {
				background: rgba(0,0,0,0.5);
			}
		`,document.head.querySelector("style[data-katex-scrollbar]")||(o.setAttribute("data-katex-scrollbar","true"),document.head.appendChild(o)),t.setAttribute("data-scrollbar-initialized","true")})}const w=()=>{window.swup.hooks.on("link:click",()=>{if(document.documentElement.style.setProperty("--content-delay","0ms"),m){const e=document.getElementById("navbar-wrapper");if(e&&document.body.classList.contains("lg:is-home")){const t=window.innerHeight*(c/100)-88;document.documentElement.scrollTop>=t&&e.classList.add("navbar-hidden")}}}),window.swup.hooks.on("content:replace",()=>{if(E(),document.getElementById("toc-wrapper")!==null){const o=document.querySelector("table-of-contents");o&&typeof o.init=="function"&&setTimeout(()=>{o.init()},100),typeof window.mobileTOCInit=="function"&&setTimeout(()=>{window.mobileTOCInit()},100)}setTimeout(()=>{typeof window.translate<"u"&&window.translate.execute()},100);const n=document.getElementById("navbar");n&&n.getAttribute("data-transparent-mode")==="semifull"&&typeof window.initSemifullScrollDetection=="function"&&window.initSemifullScrollDetection()}),window.swup.hooks.on("visit:start",e=>{const t=document.querySelector("body"),n=g(e.to.url,y("/"));n?t.classList.add("lg:is-home"):t.classList.remove("lg:is-home");const o=document.querySelector(".banner-text-overlay");o&&(n?o.classList.remove("hidden"):o.classList.add("hidden"));const i=document.getElementById("navbar");i&&(i.setAttribute("data-is-home",n.toString()),i.getAttribute("data-transparent-mode")==="semifull"&&typeof window.initSemifullScrollDetection=="function"&&window.initSemifullScrollDetection());const s=document.getElementById("banner-wrapper"),a=document.querySelector(".absolute.w-full.z-30");s&&a&&(n?(setTimeout(()=>{s.classList.remove("mobile-hide-banner")},100),setTimeout(()=>{a.classList.remove("mobile-main-no-banner")},150)):(s.classList.add("mobile-hide-banner"),setTimeout(()=>{a.classList.add("mobile-main-no-banner")},100)));const p=document.getElementById("page-height-extend");p&&p.classList.remove("hidden");let h=document.getElementById("toc-wrapper");h&&h.classList.add("toc-not-ready")}),window.swup.hooks.on("page:view",()=>{const e=document.getElementById("page-height-extend");e&&e.classList.remove("hidden"),window.scrollTo({top:0,behavior:"instant"}),setTimeout(()=>{if(document.getElementById("tcomment")){const t=new CustomEvent("mizuki:page:loaded",{detail:{path:window.location.pathname,timestamp:Date.now()}});document.dispatchEvent(t),console.log("Layout: 触发 mizuki:page:loaded 事件，路径:",window.location.pathname)}},300)}),window.swup.hooks.on("visit:end",e=>{setTimeout(()=>{const t=document.getElementById("page-height-extend");t&&t.classList.add("hidden");const n=document.getElementById("toc-wrapper");n&&n.classList.remove("toc-not-ready")},200)})};window?.swup?.hooks?w():document.addEventListener("swup:enable",w);let r=document.getElementById("back-to-top-btn"),d=document.getElementById("toc-wrapper"),l=document.getElementById("navbar-wrapper");function v(e,t){let n;return function(){const o=arguments,i=this;n||(e.apply(i,o),n=!0,setTimeout(()=>n=!1,t))}}function k(){const e=document.documentElement.scrollTop,t=window.innerHeight*(c/100);requestAnimationFrame(()=>{if(r&&(e>t?r.classList.remove("hide"):r.classList.add("hide")),m&&d&&(e>t?d.classList.remove("toc-hide"):d.classList.add("toc-hide")),m&&l){const o=document.body.classList.contains("lg:is-home")&&window.innerWidth>=1024?b:c,i=window.innerHeight*(o/100)-88;e>=i?l.classList.add("navbar-hidden"):l.classList.remove("navbar-hidden")}})}window.onscroll=v(k,16);window.onresize=()=>{let e=Math.floor(window.innerHeight*(f/100));e=e-e%4,document.documentElement.style.setProperty("--banner-height-extend",`${e}px`)};document.readyState==="loading"&&document.addEventListener("DOMContentLoaded",()=>{});
